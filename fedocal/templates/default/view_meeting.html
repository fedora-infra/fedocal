
{% if full %}
{% extends "master.html" %}

{% block title %}Meeting {{ meeting.meeting_name}}{% endblock %}

{%block tag %}home{% endblock %}

{% endif %}

{% block content %}
<section>
    <header>
        <h4>
            <a href="{{ url_for('calendar', calendar_name=meeting.calendar_name) }}">
            {{ meeting.calendar_name }}</a>
        </h4>
        {{ meeting.meeting_name}} meeting details below
    </header>

   <br>
        You are kindly invited to join to the following meeting:
        <h4> Meeting: {{ meeting.meeting_name}}</h4>      

    {% if meeting.meeting_location %}
    Location: {{ meeting.meeting_location }}
    {%endif%}

    <br>Displayed in: {{tzone}}
    <ul>
        <li>Start: {{ meeting.meeting_date }} - {{ meeting.meeting_time_start
            }} {{ tzone }} </li>
        <li>End: {{ meeting.meeting_date_end }} - {{ meeting.meeting_time_stop
            }} {{ tzone }} </li>
    </ul>

    Stored in: {{org_meeting.meeting_timezone}}
    <ul>
        <li>Start: {{ org_meeting.meeting_date }} - {{ org_meeting.meeting_time_start
            }} {{ org_meeting.meeting_timezone }} </li>
        <li>End: {{ org_meeting.meeting_date_end }} - {{ org_meeting.meeting_time_stop
            }} {{ org_meeting.meeting_timezone }} </li>
    </ul>
    Meeting information : 
    {% autoescape off%} {{ meeting.meeting_information | markdown}} {% endautoescape %}

    {% if meeting.recursion_frequency and meeting.recursion_ends %}
    
        This meeting is recurrent, it occurs every
        {{ meeting.recursion_frequency }} days until
        {{ meeting.recursion_ends }}
    
    {% endif %}
    <br>
    This meeting is organized by {{ meeting.meeting_manager|join(', ') }} as part of
    the calendar <a href="{{ url_for('calendar', calendar_name=meeting.calendar_name) }}">
    {{ meeting.calendar_name }}</a>.
    <br>
    Time left until meeting on {{ org_meeting.meeting_date }} - {{ org_meeting.meeting_time_start }} {{ org_meeting.meeting_timezone }} 
    <div id="defaultCountdown"></div>    

    {% if editor %}
    <p>
        <a href="{{ url_for('edit_meeting',
            meeting_id=meeting.meeting_id) }}">
            <img src="{{ url_for('static', filename='edit.png') }}"
                title="Edit" alt="Edit"/>
        </a>
        <a href="{{ url_for('delete_meeting',
            meeting_id=meeting.meeting_id) }}{% if from_date %}?from_date={{ from_date }}{% endif %}">
            <img src="{{ url_for('static', filename='delete.png') }}"
            title="Delete" alt="Delete"/>
        </a>
     </p>  
    {% endif %}
</section>
{% endblock %}

{% block jscripts %}
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script type="text/javascript"
        src="{{ url_for('static',
            filename='jquery.plugin.js') }}">
    </script>
    <script type="text/javascript"
        src="{{ url_for('static',
            filename='jquery.countdown.js') }}">
    </script>
    <script>
        $(function () {
        var strDate = '{{ org_meeting.meeting_date }}';
        var strTime = '{{ meeting.meeting_time_start }}';
        var dateParts = strDate.split("-");
        var timeParts = strTime.split(":");
        var hours = timeParts[0];
        var minutes = timeParts[1];        
        var date = new Date(dateParts[0], (dateParts[1] - 1), dateParts[2]);
        date.setHours(date.getHours() + hours);
        date.setMinutes(date.getMinutes() + minutes);
        $('#defaultCountdown').countdown({until: date});
        $('#year').text(date.getFullYear());
        });
    </script>
{% endblock %}
</body>
</html>
